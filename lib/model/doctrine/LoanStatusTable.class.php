<?php

/**
 * LoanStatusTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class LoanStatusTable extends DarwinTable
{
  public static function getInstance()
  {
    return Doctrine_Core::getTable('LoanStatus');
  }

  public function getDistinctStatus()
  {
    return $this->createFlatDistinct('loan_status', 'status', 'status')->execute();
  }
  
  public function getLoanStatus($loan_ref)
  {
    $q = Doctrine_Query::create()
       ->from('LoanStatus')  
       ->orderBy('modification_date_time DESC')
       ->where('loan_ref= ?', $loan_ref);
    return $q->execute();       
  }
  public function getStatusRelatedArray($loan_refs = array())
  {
    if(!is_array($loan_refs))
      $loan_refs = array($loan_refs);
        if(empty($loan_refs)) return array();
     $q = Doctrine_Query::create()->
         from('LoanStatus')->
         andWhere('is_last = ?', true)->
         andWhereIn('loan_ref', $loan_refs)->
         orderBy('id desc');
    return $q->execute();
  }

}
